/*! CoverflowJS - v2.3.0rc3 - 2013-07-24
* Copyright (c) 2008-2013 Paul Baukus, Addy Osmani, Sebastian Sauer; Licensed MIT */
(function(t){for(var e=document.body||document.documentElement,i=e.style,n=0,s=["ms","moz","webkit","o"],r=s.length,a=0,o=function(t){return t.charAt(0).toUpperCase()+t.slice(1)};r>a&&!window.requestAnimationFrame;a++)requestAnimationFrame=window[s[a]+"RequestAnimationFrame"],cancelAnimationFrame=window[s[a]+"CancelAnimationFrame"]||window[s[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||window.cancelAnimationFrame||(requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),s=window.setTimeout(function(){t(e+i)},i);return n=e+i,s},cancelAnimationFrame=function(t){clearTimeout(t)}),t.support.transform="transform"in i?"transform":!1,t.support.transition="transition"in i?"transition":!1,t.support.transform&&t.support.transition||t.each(s,function(e,n){return"ms"!==n&&(n=o(n)),t.support.transform||n+"Transform"in i&&(t.support.transform=n+"Transform"),t.support.transition||n+"Transition"in i&&(t.support.transition=n+"Transition"),t.support.transform&&t.support.transition?!1:!0})})(jQuery),function(t){var e={easeInQuad:"cubic-bezier( .55,.085,.68,.53 )",easeInCubic:"cubic-bezier( .550, .055, .675, .190 )",easeInQuart:"cubic-bezier( .895, .03, .685, .22 )",easeInQuint:"cubic-bezier( .755, .05, .855, .06 )",easeInSine:"cubic-bezier( .47, 0, .745, .715 )",easeInExpo:"cubic-bezier( .95, .05, .795, .035 )",easeInCirc:"cubic-bezier( .6, .04, .98, .335 )",easeInBack:"cubic-bezier( .6, -.28, .735, .045 )",easeOutQuad:"cubic-bezier( .25,.46,.45,.94 )",easeOutCubic:"cubic-bezier( .215,.61,.355,1 )",easeOutQuart:"cubic-bezier( .165, .84, .44, 1 )",easeOutQuint:"cubic-bezier( .23, 1, .32, 1 )",easeOutSine:"cubic-bezier( .39, .575, .565, 1 )",easeOutExpo:"cubic-bezier( .19,1,.22,1 )",easeOutCirc:"cubic-bezier( .075, .82, .165, 1 )",easeOutBack:"cubic-bezier( .175, .885, .32, 1.275 )",easeInOutQuad:"cubic-bezier( .455, .03, .515, .955 )",easeInOutCubic:"cubic-bezier( .645, .045, .355, 1 )",easeInOutQuart:"cubic-bezier( .77, 0, .175, 1 )",easeInOutQuint:"cubic-bezier( .86, 0, .07, 1 )",easeInOutSine:"cubic-bezier( .445, .05, .55, .95 )",easeInOutExpo:"cubic-bezier( 1, 0, 0, 1 )",easeInOutCirc:"cubic-bezier( .785, .135, .15, .86 )",easeInOutBack:"cubic-bezier( .68, -.55, .265, 1.55 )"},i={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},n=function(){if(null!=t.browser)return t.browser.msie&&10>~~t.msie.version;var e=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase());return null!=e&&e[1]&&10>~~e[2]}();t.widget("ui.coverflow",{options:{items:"> *",stacking:.73,active:0,duration:400,easing:"easeOutQuint",trigger:{itemfocus:!0,itemclick:!0,mousewheel:!0,swipe:!0}},isTicking:!1,_create:function(){var e=this.options;this.elementOrigStyle=this.element.attr("style"),this.items=this.element.find(e.items).each(function(){var e=t(this);e.data({coverflowOrigElemAttr:{style:e.attr("style"),"class":e.attr("class"),tabIndex:e.attr("tabIndex")}})}).addClass("ui-coverflow-item").prop("tabIndex",0),this.element.addClass("ui-coverflow").parent().addClass("ui-coverflow-wrapper ui-clearfix"),e.trigger.itemfocus&&this._on(this.items,{focus:this._select}),e.trigger.itemclick&&this._on(this.items,{click:this._select}),e.trigger.mousewheel&&this._on({mousewheel:this._onMouseWheel,DOMMouseScroll:this._onMouseWheel}),e.trigger.swipe&&this._on({swipeleft:this.next,swiperight:this.prev}),this.useJqueryAnimate=!(t.support.transition&&t.isFunction(window.requestAnimationFrame)),this.transformItems=!!t.support.transform||n,this.coverflowrafid=0},_init:function(){var e=this.options,i={};e.stacking=parseFloat(e.stacking),e.stacking=e.stacking>0&&1>e.stacking?e.stacking:.73,e.duration=~~e.duration,1>e.duration&&(e.duration=1),this.itemMargin=-Math.floor((1-e.stacking)/2*this.items.innerWidth()),this.currentIndex=this._isValidIndex(e.active,!0)?e.active:0,this.activeItem=this.items.css({marginLeft:this.itemMargin,marginRight:this.itemMargin}).removeClass("ui-state-active").eq(this.currentIndex).addClass("ui-state-active"),this.itemWidth=this.items.width(),this.itemHeight=this.items.height(),this.itemSize=this.items.outerWidth(!0),this.outerWidth=this.element.parent().outerWidth(!1),i.width=this.itemWidth*this.items.length,t.extend(i,this._getCenterPosition()),this.element.css(i),this._refresh(1,this._getFrom(),this.currentIndex),this.initialOffset=parseInt(this.activeItem.css("left"),10),this._trigger("select",null,this._ui())},_getCenterPosition:function(){var t;return t=-this.currentIndex*this.itemSize/2,t+=this.outerWidth/2-this.itemSize/2,t-=parseInt(this.element.css("paddingLeft"),10)||0,t=Math.round(t),{left:t}},_isValidIndex:function(t,e){return e=!!e,t=~~t,(this.currentIndex!==t||e)&&t>-1&&!!this.items.get(t)},_select:function(t){this.select(t.currentTarget)},next:function(){return this.select(this.currentIndex+1)},prev:function(){return this.select(this.currentIndex-1)},_getFrom:function(){return 1>=Math.abs(this.previous-this.currentIndex)?this.previousIndex:this.currentIndex+(this.previousIndex<this.currentIndex?-1:1)},select:function(e){var n,s=this.options,r=isNaN(parseInt(e,10))?this.items.index(e):parseInt(e,10);return this._isValidIndex(r)?!1===this._trigger("beforeselect",null,this._ui(this.items.eq(r),r))?!1:(this.isTicking&&(this.useJqueryAnimate?this.element.stop(!0,!1):(this.coverflowrafid&&cancelAnimationFrame(this.coverflowrafid),this.element.unbind(i[t.support.transition]))),this.isTicking=!0,this.previousIndex=this.currentIndex,this.options.active=this.currentIndex=r,n={coverflow:1},t.extend(n,this._getCenterPosition()),this.useJqueryAnimate?(this._animation(s,n),!0):(t.extend(n,{duration:s.duration,easing:s.easing}),this._transition(n),!0)):!1},_animation:function(e,i){var n=this,s=this._getFrom();t.fx.step.coverflow=function(t){n._refresh(t.now,s,n.currentIndex)},this.element.animate(i,{duration:e.duration,easing:e.easing}).promise().done(function(){n._onAnimationEnd.apply(n)})},_transition:function(n){var s=this,r=new Date,a=this._getFrom(),o=this.currentIndex,u=e[n.easing]||e.easeOutQuint,c=function(){var t=((new Date).getTime()-r.getTime())/n.duration;t>1?s.isTicking=!1:s._refresh(t,a,o),s.isTicking&&(s.coverflowrafid=requestAnimationFrame(c))};this.coverflowrafid=requestAnimationFrame(c),this.element.one(i[t.support.transition],function(){cancelAnimationFrame(s.coverflowrafid),s._refresh(1,a,o),s._onAnimationEnd(s)}).css(t.extend(this._getCenterPosition(),{transition:"left "+n.duration+"ms "+u}))},_onAnimationEnd:function(){this.isTicking=!1,this.activeItem=this.items.removeClass("ui-state-active").eq(this.currentIndex).addClass("ui-state-active"),this._trigger("select",null,this._ui())},_refresh:function(e,i,s){var r=this;this.element.parent().scrollTop(0),this.items.each(function(a){var o,u,c=a===s&&0>i-s||a-s>0?"left":"right",h=a===s?1-e:a===i?e:1,m={zIndex:r.items.length+("left"===c?s-a:a-s)},l=1+.3*(1-h);m.left=-a*(r.itemSize/2)+("right"===c?-r.itemSize/2:r.itemSize/2)*h,r.transformItems&&(o=[l,h*("right"===c?-.2:.2),0,l,0,0],n&&!t.support.transform?(this.filters["DXImageTransform.Microsoft.Matrix"]||(this.style.filter=(this.style.filter?"":" ")+'progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand")'),u=this.filters["DXImageTransform.Microsoft.Matrix"],u.M11=o[0],u.M12=o[2],u.M21=o[1],u.M22=o[3]):m.transform="matrix("+o.join(",")+")"),t(this).css(m)})},_ui:function(t,e){return{active:t||this.activeItem,index:null!=e?e:this.currentIndex}},_onMouseWheel:function(t){var e=t.originalEvent;return t.preventDefault(),e.wheelDelta>0||0>e.detail?(this.prev(),void 0):(this.next(),void 0)},_destroy:function(){void 0!==this.elementOrigStyle?this.element.attr("style",this.elementOrigStyle):this.element.removeAttr("style"),this.element.removeClass("ui-coverflow").parent().removeClass("ui-coverflow-wrapper ui-clearfix"),this.items.removeClass("ui-coverflow-item ui-state-active").each(function(){var e=t(this),i=e.data("coverflowOrigElemAttr");t.each(i,function(t,i){void 0!==i?e.attr(t,i):e.removeAttr(t)}),e.data("coverflowOrigElemAttr",null)}),this._super()}})}(jQuery);